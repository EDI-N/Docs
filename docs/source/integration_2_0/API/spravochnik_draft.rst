##############
API Справочник
##############

| **Сокращения и условные обозначения:**
| GLN - Global Location Number (глобальный номер местоположения)
| ИНН - Идентификационный номер налогоплательщика
| КПП - Код причины постановки на учет в разных налоговых органах
| GTIN - Global Trade Item Number (штрих-код)

--------------

.. contents:: Содержание:

--------------

Применяемые HTTP-коды ответов сервера с API (intCode):

-  200 — OK
-  400 — Ошибка в параметрах запроса
-  401 — Не авторизован, в запросе отсутствует token
-  403 — Нет доступа к запрашиваемой информации
-  404 — Запрашиваемая информация не найдена
-  500 — Внутренняя ошибка сервера
-  501 — Метод не существует
-  503 — Сервис недоступен, техническое обслуживание, повторите запрос позже

Время жизни токена в случае бездействия пользователя - 10 минут. В ответ пользователь получает json пакет с HTTP кодом.

API для работы с платформой **EDIN 2.0**. Запросы методов направляются на адрес ​ https://edo-v2.edi-n.com . Передаваемые в cURL-запросе параметры являются обязательными, если не указано обратное (их опциональность).

-  Обмен данными происходит посредством запросов на сервер (в дальнейшем "API")
-  Обмен данными происходит в формате JSON
-  Возврат данных происходит в формате JSON
-  Передача изображений, печатных форм, неструкт. документов и подписей реализована в формате строки BASE64

--------------

Проверки
========

Проверка активности сервера:

.. code:: ruby

    curl -X GET 'https://edo-v2.edi-n.com/ping'

Проверка активности сессии:

.. code:: ruby

    curl -X GET 'https://edo-v2.edi-n.com/api/auth_check' -b 'SID=65daca25-74ba-4c85-8183-71b404a348c0;'

--------------

**Авторизация**
===============


+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+
| **Метод запроса** |                                                                 HTTP POST                                                                  |                                                                  |
+===================+============================================================================================================================================+==================================================================+
| **Content-Type**  | application/json                                                                                                                           | тело запроса/ответа в json формате                               |
+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+
| **cURL запроса**  | curl -X POST 'https://edo-v2.edi-n.com/api/oas/authorization' -d 'email=uaEDSsender&password=111&api_key=66B4814DEC28B4CA17DE56338A52D7DB' | **email** - строка; логин пользователя;                          |
|                   |                                                                                                                                            |                                                                  |
|                   |                                                                                                                                            | **password** - строка, пароль пользователя на платформе EDIN 2.0 |
|                   |                                                                                                                                            |                                                                  |
|                   |                                                                                                                                            | **api_key** - строка, пароль доступа к API                       |
+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+


**Пример ответа:**

При успешной авторизации получаем в ответ "токен" ( ``'SID=65daca25-74ba-4c85-8183-71b404a348c0;'`` ) для дальнейшей работы:

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение информации по авторизированному пользователю**
==========================================================

+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+
| **Метод запроса** |                                              HTTP GET                                              |                                            |
+===================+====================================================================================================+============================================+
| **Content-Type**  | application/json                                                                                   | тело запроса/ответа в json формате         |
+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/user' -b 'SID=65daca25-74ba-4c85-8183-71b404a348c0;' | **SID** - токен полученный при авторизации |
+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение информации по GLN номерам, связанным с авторизированным пользователем (на уровне аккаунта)**
========================================================================================================

+-------------------+------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
| **Метод запроса** |                                                     HTTP GET                                                     |                                            |
+===================+==================================================================================================================+============================================+
| **Content-Type**  | application/json                                                                                                 | тело запроса/ответа в json формате         |
+-------------------+------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/company/identifiers' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **SID** - токен полученный при авторизации |
+-------------------+------------------------------------------------------------------------------------------------------------------+--------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение информации по конкретному GLN-у, который связан с авторизированным пользователем (на уровне аккаунта)**
===================================================================================================================

+-------------------+---------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| **Метод запроса** |                                                         HTTP GET                                                          |                                                                        |
+===================+===========================================================================================================================+========================================================================+
| **Content-Type**  | application/json                                                                                                          | тело запроса/ответа в json формате                                     |
+-------------------+---------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/company/identifier?id=133187' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **id** - идентификатор (номер) аккаунта авторизированного пользователя |
|                   |                                                                                                                           |                                                                        |
|                   |                                                                                                                           | **SID** - токен полученный при авторизации                             |
+-------------------+---------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение информации об организации по Названию/ИНН/КПП/GLN**
===============================================================

+-------------------+----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Метод запроса** |                                                                HTTP GET                                                                |                                                                                                                                                                            |
+===================+========================================================================================================================================+============================================================================================================================================================================+
| **Content-Type**  | application/json                                                                                                                       | тело запроса/ответа в json формате                                                                                                                                         |
+-------------------+----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/identifiers?gln=9864065702429&query=EDS_1' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **gln** - строка(13); номер GLN организации, которая связана с авторизированным пользователем платформы EDIN 2.0 на уровне аккаунта; "от которого осуществляется действие" |
|                   |                                                                                                                                        |                                                                                                                                                                            |
|                   |                                                                                                                                        | **query** - строка; название/ИНН/КПП/GLN организации; "над которым осуществляется действие"                                                                                |
|                   |                                                                                                                                        |                                                                                                                                                                            |
|                   |                                                                                                                                        | **SID** - токен полученный при авторизации                                                                                                                                 |
+-------------------+----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение списка доступных единиц измерения**
===============================================

+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+
| **Метод запроса** |                                              HTTP GET                                              |                                            |
+===================+====================================================================================================+============================================+
| **Content-Type**  | application/json                                                                                   | тело запроса/ответа в json формате         |
+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/units' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **SID** - токен полученный при авторизации |
+-------------------+----------------------------------------------------------------------------------------------------+--------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение списка всех розничных сетей**
=========================================

+-------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------------------+
| **Метод запроса** |                                                 HTTP GET                                                  |                                            |
+===================+===========================================================================================================+============================================+
| **Content-Type**  | application/json                                                                                          | тело запроса/ответа в json формате         |
+-------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/allretailers' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **SID** - токен полученный при авторизации |
+-------------------+-----------------------------------------------------------------------------------------------------------+--------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение списка розничных сетей, которые связаны с заданным GLN**
====================================================================

+-------------------+--------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **Метод запроса** |                                                         HTTP GET                                                         |                                                                                                                                     |
+===================+==========================================================================================================================+=====================================================================================================================================+
| **Content-Type**  | application/json                                                                                                         | тело запроса/ответа в json формате                                                                                                  |
+-------------------+--------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/retailers?gln=9864065702429' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **SID** - токен полученный при авторизации                                                                                          |
|                   |                                                                                                                          |                                                                                                                                     |
|                   |                                                                                                                          | **gln** - строка(13); номер GLN организации, которая связана с авторизированным пользователем платформы EDIN 2.0 на уровне аккаунта |
+-------------------+--------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------

**Получение списка GLN номеров, которые связаны с заданной розничной сетью**
============================================================================

+-------------------+-------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------+
| **Метод запроса** |                                                              HTTP GET                                                               |                                                                               |
+===================+=====================================================================================================================================+===============================================================================+
| **Content-Type**  | application/json                                                                                                                    | тело запроса/ответа в json формате                                            |
+-------------------+-------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------+
| **cURL запроса**  | curl -X GET 'https://edo-v2.edi-n.com/api/oas/retailer/identificators?retailer_id=11' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb' | **SID** - токен полученный при авторизации                                    |
|                   |                                                                                                                                     |                                                                               |
|                   |                                                                                                                                     | **retailer_id** - число; идентификатор розничной сети (из предыдущих методов) |
+-------------------+-------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------+



**Пример ответа:**

.. code:: ruby

    пример отсутствует

--------------
