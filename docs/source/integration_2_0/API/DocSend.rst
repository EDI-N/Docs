######################################################################
Отправка черновика
######################################################################

Для работы с этим методом пользователь должен быть `авторизированным <https://ссылка на авторизацию>`__ .

С помощью метода **/api/eds/doc/send** возможна отправка черновика в определенную цепочку.

+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
|                      **Метод запроса**                      |                                                           **HTTP PATCH**                                                            |
+=============================================================+=====================================================================================================================================+
| **Content-Type**                                            | application/json (тело запроса/ответа в json формате в теле HTTP запроса                                                            |
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **URL запроса**                                             | https://edo-v2.edi-n.com//api/eds/doc/send                                                                                          |
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **Параметры, передаваемые в URL (вместе с адресом метода)** | В строке заголовка (Header) "Set-Cookie" обязательно передается **SID** - токен полученный при авторизации                          |
|                                                             |                                                                                                                                     |
|                                                             | **Обязательные url-параметры:**                                                                                                     |
|                                                             |                                                                                                                                     |
|                                                             | **gln** - строка(13); номер GLN организации, которая связана с авторизированным пользователем платформы EDIN 2.0 на уровне аккаунта |
|                                                             |                                                                                                                                     |
|                                                             | **doc_uuid** - строка; UUID документа                                                                                               |
|                                                             |                                                                                                                                     |
|                                                             | **doc_hash** - строка; хэш документа                                                                                                |
|                                                             |                                                                                                                                     |
|                                                             | **chain_hash** - строка; хэш цепочки                                                                                                |
|                                                             |                                                                                                                                     |
|                                                             | **chain_uuid** - строка; ID цепочки                                                                                                 |
|                                                             |                                                                                                                                     |
|                                                             | **partner_id** - число; ID ритейлера или 0 если не ритейлер                                                                         | 
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

**Внимание:** В запросе в теле json присутствуют обязательные (должны передаваться) и опциональные параметры (колонка Тип_).

.. hint:: Также возможно выполнить запрос в виде curl-строки:
          
          curl -X PATCH 'https://edo-v2.edi-n.com/api/eds/doc/send?gln=9864065702429&doc_uuid=8c8a70e7-81c6-4382-8b58-7d60c3bc6ffd&doc_hash=704DD5F0A71FCB730D2B1AEA84FEE3FB&chain_hash=704DD5F0A71FCB730D2B1AEA84FEE3FB&chain_uuid=8c8a70e7-81c6-4382-8b58-7d60c3bc6ffd&partner_id=11' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb'

Спецификация для расшифровки ключей curl запроса: https://curl.haxx.se/docs/manpage.html

--------------

JSON-параметры в теле HTTP **запроса/ответа**
============================================================

Таблица 1 - Описание json-параметров (фильтр) **запроса** метода API
!добавить таблицу!

+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| Наименование | Формат  |                     Описание (field_description, как аналогия с dbpro)                     |
+===========================+=====================+============================================================================================+
| created_from              | UUID                | NULL                                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| is_signed                 | TINYINT             | NULL                                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| encrypted                 | TINYINT             | NULL                                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| comdoc_reestr_id          | INT                 | index_comdoc2reestr                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| comdoc_reestr_is_active   | TINYINT             | index_comdoc2reestr                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| ftpex_file_name           | VARCHAR             | index_ftpexdoc                                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| ftpex_file_date           | INT                 | index_ftpexdoc                                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| inv_date                  | INT                 | index_varinvdate                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| inv_num                   | VARCHAR             | index_varinvnum                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| error_code                | INT                 | index_interrorcode                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sub_doc_type_id           | INT                 | index_intsubdoctypeid                                                                      |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sub_status_id             | INT                 | index_intsubstatusid                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| action                    | VARCHAR             | index_varaction                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| buyer_uuid                | VARCHAR             | index_varbuyer                                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| consignee_uuid            | VARCHAR             | index_varconsignee                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| consignor_uuid            | VARCHAR             | index_varconsignor                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| customer_uuid             | VARCHAR             | index_varcustomer                                                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| performer_uuid            | VARCHAR             | index_varperformer                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| supplier_uuid             | VARCHAR             | index_varsupplier                                                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| delivery_place_uuid       | VARCHAR             | index_vardeliveryplace                                                                     |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| contract_date             | VARCHAR             | index_varcontractdate                                                                      |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| contract_number           | VARCHAR             | index_varcontractnum                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| delivery_date             | INT                 | index_vardeliverydate                                                                      |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| order_number              | VARCHAR             | index_varordnum                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| order_date                | INT                 | index_varorderdate                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| return_date               | INT                 | index_varreturndate                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| summ                      | VARCHAR             | index_vardocsumm                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| parent_chain_hash         | MD5                 | index_varparentchainhash                                                                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| period                    | VARCHAR             | index_varperiod                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| text_uvutoch              | TEXT                | index_vartextuvutoch                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trans_id                  | VARCHAR             | index_vartransid                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| ttn                       | VARCHAR             | index_varttn                                                                               |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_start_date            | VARCHAR             | index_docdurdate                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_end_date              | VARCHAR             | index_docdurdate                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| delivery_note_number      | VARCHAR             | index_intdeliverynotenumber                                                                |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| rep_destination           | TINYINT             | index_repdestnation                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| tax_doc_guid              | UUID                | index_taxdocguid                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| tax_exch_guid             | UUID                | index_taxexchguid                                                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| tax_recipient             | VARCHAR             | index_taxrecipient                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| tax_sender                | VARCHAR             | index_taxsender                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| tax_state_id              | TINYINT             | index_taxstateid                                                                           |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| contract_gln              | VARCHAR             | index_varcontractgln                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_date                  | INT                 | index_vardate - дата из документа                                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| delivery_agreement_number | VARCHAR             | index_vardeliveryagreementdata                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| delivery_agreement_date   | INT                 | index_vardeliveryagreementdata                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| varn                      | VARCHAR             | index_varn - юзд id документа                                                              |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| other_info                | TEXT                | index_varotherinfo                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sub_doc_date              | INT                 | index_varsubdocdate                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sub_doc_number            | VARCHAR             | index_varsubdocnumber                                                                      |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_error                 | TEXT                | doc_error                                                                                  |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_info                  | TEXT                | doc_info                                                                                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| old_doc_id                | INT                 | intDocID                                                                                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sub_status_date           | INT                 | index_intsubstatusid                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| from_doc_id               | INT                 | intFromDocID                                                                               |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| doc_num                   | VARCHAR             | index_vardocnum                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| sender                    | VARCHAR             | index_varsender                                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| recipient                 | VARCHAR             | index_varrecipient                                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| file_name                 | VARCHAR             | condra_body, agreem_body                                                                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| xml_hash                  | VARCHAR             | comdocs_dsigns                                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| answer_doc_id             | INT                 | comdoc_answer_doc                                                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| manager_name              | VARCHAR             | tander_logistic - менеджер, создатель документа                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| consignors_list           | VARCHAR             | tander_logistic - список грузоотправителей                                                 |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| consignees_list           | VARCHAR             | tander_logistic - список грузополучателей                                                  |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| car_info                  | VARCHAR             | tander_logistic - гос. номер ТС                                                            |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| driver_info               | VARCHAR             | tander_logistic - ФИО водителя                                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_date_from            | INT                 | index_iftmbfdopinfo.varDateFrom - дата подачи                                              |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_date_end             | INT                 | index_iftmbfdopinfo.varPlanEndTripDate - плановое завершение рейса, дата                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_date_end_actual      | INT                 | index_iftmbfdopinfo.varActualPlanEndTrip                                                   |
|                           |                     | Date - aктуальное плановое завершение рейса, дата                                          |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_time_from            | INT                 | index_iftmbfdopinfo.varTimeFrom - время подачи                                             |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_time_end             | INT                 | index_iftmbfdopinfo.varPlanEndTripTime - плановое завершение рейса, время                  |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_time_end_actual      | INT                 | index_iftmbfdopinfo.varActualPlanEndTripTime - aктуальное плановое завершение рейса, время |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_tonnage              | VARCHAR             | index_iftmbfdopinfo.varTonnage - тоннаж ТС                                                 |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_unload_type          | VARCHAR             | index_iftmbfdopinfo.varUnloadType - высота борта ТС                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_pallet_amount        | INT                 | index_iftmbfdopinfo.varPalletAmount - паллетовместимость                                   |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_zone                 | VARCHAR             | index_iftmbfdopinfo.varZone - зона                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_cargo_type           | VARCHAR             | index_iftmbfdopinfo.varCargoType - тип отгружаемого товара                                 |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_version_info         | TEXT                | index_iftmbfdopinfo.varVersionInfo                                                         |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| trip_region               | VARCHAR             | index_iftmbfdopinfo.varRegion - регион                                                     |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| identifier                | VARCHAR             | index_varidentifier                                                                        |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| relative_chain_hash       | MD5                 | index_varrelativechainhash                                                                 |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+
| compound_number           | VARCHAR             | index_compoundnumber                                                                       |
+---------------------------+---------------------+--------------------------------------------------------------------------------------------+

--------------

В этом методе json-тело **ответа** отсутствует.

--------------

Примеры
===============

**Пример тела запроса (json):**

.. code:: ruby

{
  "extra_fields": {
    "sender": "4820128010004",
    "doc_num": "ORG00000014",
    "buyer_uuid": "4820128010004",
    "delivery_date": "1551477600",
    "order_number": "6422722fb78c4509b06eac43758e1545",
    "supplier_uuid": "9864065702429",
    "contract_number": "334455",
    "delivery_place_uuid": "4820128019007",
    "order_date": "1550181600",
    "doc_date": "1555432208",
    "action": "29"
  }
}

--------------

**Пример тела ответа (json):**

В этом методе json-тело **ответа** отсутствует.

Возвращаемый текст – «OK»






