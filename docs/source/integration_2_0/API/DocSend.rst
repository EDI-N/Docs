######################################################################
**Отправка черновика**
######################################################################

Для работы с этим методом пользователь должен быть `авторизированным <https://wiki.edi-n.com/ru/latest/integration_2_0/API/Authorization.html>`__ .

С помощью метода **/api/eds/doc/send** возможна отправка черновика в определенную цепочку.

+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
|                      **Метод запроса**                      |                                                           **HTTP PATCH**                                                            |
+=============================================================+=====================================================================================================================================+
| **Content-Type**                                            | application/json (тело запроса/ответа в json формате в теле HTTP запроса                                                            |
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **URL запроса**                                             | https://edo-v2.edi-n.com/api/eds/doc/send                                                                                           |
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
| **Параметры, передаваемые в URL (вместе с адресом метода)** | В строке заголовка (Header) "Set-Cookie" обязательно передается **SID** - токен полученный при авторизации                          |
|                                                             |                                                                                                                                     |
|                                                             | **Обязательные url-параметры:**                                                                                                     |
|                                                             |                                                                                                                                     |
|                                                             | **gln** - строка(13); номер GLN организации, которая связана с авторизированным пользователем платформы EDIN 2.0 на уровне аккаунта |
|                                                             |                                                                                                                                     |
|                                                             | **doc_uuid** - строка; UUID документа                                                                                               |
|                                                             |                                                                                                                                     |
|                                                             | **doc_hash** - строка; хэш документа                                                                                                |
|                                                             |                                                                                                                                     |
|                                                             | **chain_hash** - строка; хэш цепочки                                                                                                |
|                                                             |                                                                                                                                     |
|                                                             | **chain_uuid** - строка; ID цепочки                                                                                                 |
|                                                             |                                                                                                                                     |
|                                                             | **partner_id** - число; ID ритейлера или 0 если не ритейлер                                                                         | 
+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

**Внимание:** В запросе в теле json присутствуют обязательные (должны передаваться) и опциональные параметры (колонка Тип_).

.. hint:: Также возможно выполнить запрос в виде curl-строки:
          
          curl -X PATCH 'https://edo-v2.edi-n.com/api/eds/doc/send?gln=9864065702429&doc_uuid=8c8a70e7-81c6-4382-8b58-7d60c3bc6ffd&doc_hash=704DD5F0A71FCB730D2B1AEA84FEE3FB&chain_hash=704DD5F0A71FCB730D2B1AEA84FEE3FB&chain_uuid=8c8a70e7-81c6-4382-8b58-7d60c3bc6ffd&partner_id=11' -b 'SID=458a0d38-5b56-4b8e-8998-009a1edd31eb'

Спецификация для расшифровки ключей curl запроса: https://curl.haxx.se/docs/manpage.html

--------------

**JSON-параметры в теле HTTP запроса/ответа**

--------------

**REQUEST**

--------------

Таблица 1 - Описание json-параметров (фильтр) **запроса** метода API

+------------------------+------+-------------------------------+-------------------------------------------------------------------------------------------+
|      Наименование      | Тип_ |            Формат             |                                         Описание                                          |
+========================+======+===============================+===========================================================================================+
| **extra_fields**       |      | **Map<String, String>**       | массив объектов; набор индексов                                                           |
+------------------------+------+-------------------------------+-------------------------------------------------------------------------------------------+
| **multi_extra_fields** |      | **Map<String, List<String>>** | массив объектов; мультииндекс. Может быть использован для индексирования элементов строки |
+------------------------+------+-------------------------------+-------------------------------------------------------------------------------------------+

Таблица 2 - Описание **extra_fields** параметров

.. csv-table:: 
  :file: for_csv/extra_fields.csv
  :widths:  1, 2, 7, 12, 41
  :header-rows: 1
  :stub-columns: 0


.. _Тип:

Тип поля: **M - mandatory** (обязательное к заполнению), **O - optional** (опциональное)

--------------

**RESPONSE**

--------------

В этом методе json-тело **ответа** отсутствует.

--------------

**Примеры**

--------------

**Пример тела запроса (json):**

.. code:: ruby

  {
    "extra_fields": {
      "sender": "4820128010004",
      "doc_num": "ORG00000014",
      "buyer_uuid": "4820128010004",
      "delivery_date": "1551477600",
      "order_number": "6422722fb78c4509b06eac43758e1545",
      "supplier_uuid": "9864065702429",
      "contract_number": "334455",
      "delivery_place_uuid": "4820128019007",
      "order_date": "1550181600",
      "doc_date": "1555432208",
      "action": "29"
    }
  }

--------------

**Пример тела ответа (json):**

В этом методе json-тело **ответа** отсутствует.

Возвращаемый текст – «OK»






